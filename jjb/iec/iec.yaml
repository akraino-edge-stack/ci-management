---
- project:
    name: 'iec'
    project-name: 'iec'
    project: '{project-name}'
    views:
      - common-view:
          view-name: iec
          view-regex: '^{project-name}-(tox|type1|type2)-(verify|fuel|compass)-.*'
    # -------------------------------
    # BRANCH DEFINITIONS
    # -------------------------------
    stream:
      - master:
          branch: '{stream}'
          gs-pathname: ''
          disabled: false

    # -------------------------------
    # INSTALLER DEFINITIONS
    # -------------------------------
    installer:
      - fuel
      - compass

    # -------------------------------
    # OPERATING SYSTEM DEFINITIONS
    # -------------------------------
    os:
      - ubuntu1604
      - ubuntu1804
      - centos7
    #--------------------------------
    # IEC TYPE DEFINITINONS
    # type1 Mcbin embeded board
    # type2 Arm Server
    # -------------------------------
    iecType:
      - type1
      - type2
    # -------------------------------
    # DEPLOY TYPE DEFINITIONS
    # -------------------------------
    deploy_type:
      - baremetal:
          slave-label: 'aarch64_dev'
          scenario: 'k8-calico-iec-noha'
      - virtual:
          slave-label: 'aarch64_dev'
          scenario: 'k8-calico-iec-noha'

    exclude:
      # Compass does not run against baremetal PODs yet
      - installer: compass
        deploy_type: baremetal
      - installer: compass
        os: centos7
      - installer: compass
        os: ubuntu1804
      - iecType: type1
        installer: fuel

    # -------------------------------
    # USECASE DEFINITIONS
    # -------------------------------
    usecase:
      - seba_on_arm:
          slave-label: 'aarch64_dev'
          scenario: 'k8-calico-iec-noha'

    jobs:
      - akraino-iec-install
      - akraino-iec-deploy
      - akraino-iec-destroy
      - akraino-iec-install-usecase
      - gerrit-sonar:
          sonar-project-file: ""
          build-node: centos7-builder-2c-1g
          sonar-properties: |
            # Required metadata
            sonar.projectKey=iec
            sonar.projectName=iec
            sonar.organization=akraino-edge-stack

            #Source
            sonar.sources=.
            sonar.exclusions=**/*_test.go,**/vendor/**

            # Language
            sonar.language=go

            # Encoding
            sonar.build.sourceEncoding=UTF-8

            # Inclusions
            sonar.inclusions=**/**.go

            # Test Execution
            sonar.tests=.
            sonar.test.inclusions=**/*_test.go
            sonar.test.exclusions=**/vendor/**

########################
# trigger macros
########################
# CI PODs
# ----------------------------------------------------------------
# Akraino IEC CI Baremetal Triggers running against master branch
# ----------------------------------------------------------------
- trigger:
    name: 'iec-type2-fuel-virtual-ubuntu1604-daily-master-trigger'
    triggers:
      - timed: '0 1 * * 1,3,5'
- trigger:
    name: 'iec-type2-fuel-baremetal-ubuntu1604-daily-master-trigger'
    triggers:
      - timed: ''
- trigger:
    name: 'iec-type2-compass-virtual-ubuntu1604-daily-master-trigger'
    triggers:
      - timed: '0 13 * * *'
- trigger:
    name: 'iec-type2-fuel-virtual-ubuntu1804-daily-master-trigger'
    triggers:
      - timed: '0 1 * * 2,6'
- trigger:
    name: 'iec-type2-fuel-baremetal-ubuntu1804-daily-master-trigger'
    triggers:
      - timed: ''
- trigger:
    name: 'iec-type2-fuel-virtual-centos7-daily-master-trigger'
    triggers:
      - timed: '0 1 * * 4,7'
- trigger:
    name: 'iec-type2-fuel-baremetal-centos7-daily-master-trigger'
    triggers:
      - timed: ''
- trigger:
    name: 'iec-type1-compass-virtual-ubuntu1604-daily-master-trigger'
    triggers:
      - timed: '0 19 * * *'

